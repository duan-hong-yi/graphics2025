# OpenGL 简易太阳系渲染项目

# 项目介绍

本项目是基于 OpenGL 3.3 核心剖面实现的简易太阳系渲染程序，核心呈现太阳与地球的可视化效果，集成了纹理映射、光照计算、球体公转及鼠标交互检测等功能，适合 OpenGL 入门学习者理解 3D 渲染管线、着色器编程及射线拾取等核心技术。

# 核心功能

- 太阳渲染：采用自发光着色器，加载太阳纹理并增强发光效果，模拟太阳的光亮特性；

- 地球渲染：支持漫反射贴图与法线贴图，结合 Phong 光照模型（环境光+漫反射+镜面反射），呈现地球表面细节与光影变化；

- 地球公转：通过时间变量控制地球绕太阳的圆周运动，模拟太阳系基本天体运行规律；

- 鼠标交互：鼠标左键点击窗口中的太阳或地球，控制台会打印对应球体名称，未点击到球体时提示“未点击到任何球体”；

- 窗口适配：支持窗口大小调整，自动更新投影矩阵以保证渲染效果正常。

# 环境依赖

运行本项目需提前配置以下依赖库，推荐使用支持 C++11 及以上标准的编译器：

- GLFW 3.3：用于创建窗口、处理输入事件（鼠标点击、窗口大小调整）；

- GLAD：用于加载 OpenGL 核心功能函数（需适配 OpenGL 3.3 核心剖面）；

- GLM 0.9.9：用于矩阵运算、向量计算（支撑 3D 空间变换与光照计算）；

- stb_image：用于加载纹理图片（项目已通过宏定义集成实现，无需额外编译）。

# 编译与运行步骤

## 1. 资源准备

项目依赖 3 张纹理图片，需提前准备并放置在指定路径（或修改代码中的纹理路径）：

- 太阳纹理：`太阳_2K.jpg`（自发光漫反射贴图）；

- 地球漫反射纹理：`世界地球日地图_2K.jpg`；

- 地球法线纹理：`地球法线贴图_2K.jpg`。

修改代码中纹理加载路径（位于 `initResources()` 函数）：

```cpp

sunTex = loadTexture("你的纹理路径/太阳_2K.jpg");
earthDiffuseTex = loadTexture("你的纹理路径/世界地球日地图_2K.jpg");
earthNormalTex = loadTexture("你的纹理路径/地球法线贴图_2K.jpg", true);
```

## 2. 项目配置

根据使用的编译工具（如 Visual Studio、CMake、Code::Blocks）配置项目：

- 添加头文件路径：将 GLFW、GLAD、GLM、stb_image 的头文件目录添加到项目包含目录；

- 添加库文件路径：将 GLFW 的库文件目录（如 `glfw3.lib`）添加到项目库目录；

- 链接依赖库：根据编译器类型链接对应库（如 Windows 下链接 `glfw3.lib`、`opengl32.lib`）。

## 3. 编译与运行

- 编译项目：生成可执行文件（确保无编译错误，若出现纹理加载失败，优先检查路径是否正确）；

- 运行程序：启动可执行文件，将看到黑色背景（模拟宇宙）、中心发光的太阳，以及绕太阳公转的地球；

- 交互测试：用鼠标左键点击太阳或地球，查看控制台输出的球体名称。

# 项目结构说明

```cpp

.
├── 核心代码模块
│   ├── 主函数（main）：初始化 GLFW/GLAD、配置窗口、启动渲染循环
│   ├── 着色器源码：太阳（顶点+片段）、地球（顶点+片段）着色器
│   ├── 辅助函数：
│   │   ├── 窗口/错误回调：处理窗口大小调整、GLFW 错误信息
│   │   ├── 着色器编译：compileShader（编译单个着色器）、createShaderProgram（链接着色器程序）
│   │   ├── 球体生成：generateSphere（生成带法线/切线/副切线的球体顶点数据）
│   │   ├── 纹理加载：loadTexture（加载漫反射/法线纹理，支持翻转、过滤模式配置）
│   │   ├── 渲染函数：renderFrame（核心渲染逻辑，更新矩阵、绘制太阳/地球）
│   │   └── 资源释放：releaseResources（删除 VAO/VBO/EBO、着色器、纹理）
│   └── 交互模块：
│       ├── 射线结构体（Ray）：存储射线起点与方向
│       ├── 球体信息结构体（SphereInfo）：存储球体名称、世界坐标、半径
│       ├── 射线-球体相交检测：raySphereIntersect（核心碰撞算法）
│       ├── 屏幕坐标转射线：screenToWorldRay（窗口坐标→NDC→世界空间射线）
│       └── 鼠标回调：mouseButtonCallback（监听左键点击，触发拾取逻辑）
└── 资源文件
    ├── 太阳_2K.jpg       太阳纹理
    ├── 世界地球日地图_2K.jpg  地球漫反射纹理
    └── 地球法线贴图_2K.jpg   地球法线纹理
```

# 核心技术点

1. 3D 渲染管线：通过 VAO/VBO/EBO 管理顶点数据，实现球体的批量绘制；

2. 着色器编程：区分太阳（自发光）与地球（光照+法线贴图）的着色器逻辑，实现差异化渲染；

3. 矩阵变换：通过 model（模型变换）、view（视图变换）、projection（投影变换）矩阵，将顶点从局部空间转换到裁剪空间；

4. 纹理映射：支持漫反射纹理与法线贴图，通过 TBN 矩阵将法线贴图的切线空间法线转换为世界空间，适配光照计算；

5. Phong 光照模型：结合环境光、漫反射光、镜面反射光，模拟地球表面的真实光影效果；

6. 射线拾取：通过屏幕坐标转射线、射线-球体相交检测，实现鼠标与 3D 球体的交互。

# 演示图
[点击示例图.png]